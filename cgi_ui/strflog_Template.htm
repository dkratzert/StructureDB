<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>StructureFinder</title>

    <link rel="stylesheet" href="http://127.0.0.1/bootstrap3/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://127.0.0.1/jasny-bootstrap/css/jasny-bootstrap.min.css">

    <script src="http://127.0.0.1/jquery/jquery.min.js"></script>
    <script src="http://127.0.0.1/bootstrap3/js/bootstrap-3.2.0.min.js"></script>
    <script src="http://127.0.0.1/jasny-bootstrap/js/jasny-bootstrap-3.1.3.min.js"></script>

    <script src="http://127.0.0.1/jsmol/JSmol.min.nojq.js"></script>

    <!--
    <script href="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script href="https://cdnjs.cloudflare.com/ajax/libs/jasny-bootstrap/3.1.3/js/jasny-bootstrap.min.js"></script>
   -->


<style type="text/css">


body {
    background-color: #f0f0f0;
    /*font-size: 1.3em; */
    font-size: 12px;
    line-height: inherit;
}

#mystrtable {
    /* Format the whole table */
    height: 400px; /* Will be changed by Javascript below */
    /*max-width: 100%;*/
    overflow: auto;
    outline: solid 1px;
}

#mystrtable tr td{
    line-height: 5px;
    min-height: 5px;
    height: 5px;
}
/*
#myresidualtable {
    max-width: 70%;
    alignment: left;
    overflow: auto;
}*/
/*
#myresidualtable tr td {
    line-height: 8px;
    min-height: 8px;
    height: 8px;
    font-size: 1.2em;
}
*/

</style>



<script>

$(document).ready(function() {

Info = {
	width: 300,
	height: 300,
	debug: false,
	j2sPath: "http://127.0.0.1/jsmol/j2s",
	color: "0xC0C0C0",
    disableJ2SLoadMonitor: true,
    disableInitialConsole: true,
	addSelectionOptions: false,
	use: "HTML5",
	readyFunction: null,
	script: "set antialiasDisplay; zoom 110;load http://127.0.0.1/breit_tb13_85.cif"
};

$("#jsmoldiv").html(Jmol.getAppletHtml("jmolApplet0", Info))

});


</script>




</head>

<body>

<div class="container">

<form action="strflog.cgi" enctype="multipart/form-data" method="POST">
<h1>StructureFinder</h1>
    <div id="mystrtable" class="col-md-12">
    <table class="table table-striped table-bordered table-hover table-responsive">
        <thead>
            <tr>
                <th> filename </th>
                <th> dataname </th>
                <th> directory </th>
            </tr>
        </thead>
        <tbody class="rowlink" data-link="row" data-target="a.id">
            $logtablecolumns
        </tbody>
    </table>
    </div>
</form>
</div>


<div class="container">
<h4>Search structures</h4>
<form action="strflog.cgi" enctype="multipart/form-data" method="POST">
    <div class="form-group row">
        <div class="col-sm-6">
            <div class="input-group input-group-sm">
                <input type="text" class="form-control" placeholder="Search Unit Cell" id="cell" name="cell">
                    <div class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                        <i class="glyphicon glyphicon-search"></i>
                    </button>
                    </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="input-group input-group-sm">
                <input type="text" class="form-control" placeholder="Search Text" id="text" name="text">
                    <div class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                        <i class="glyphicon glyphicon-search"></i>
                    </button>
                    </div>
            </div>
        </div>
    </div>
</form>

<span id=jsmoldiv></span>

<div class="row">
    <div class="col-sm-10">
        <span id="residuals"></span>
    </div>
    <div class="col-sm-2">

    </div>
</div>

<br>
<br>
<br>
<br>
<address>
  <strong>made by Daniel Kratzert</strong><br>
  <a href="mailto:daniel.kratzert@ac.uni-freiburg.de">daniel.kratzert@ac.uni-freiburg.de</a>
</address>

<!-- The main container div: -->
</div>



<!-- Javascript functions start here: -->
<script>

jQuery(document).ready(function($) {

    // height of cif list to 35% of the screen height
    $(document).ready(function(){
        //gets the window's height
        var b = $(window).height();
        var h = b * 0.35;
        $("#mystrtable").css("height", h);
    });

    $('#mystrtable').find('tr').click(function() {
        var idstr = $(this).find("a").attr("id");
        //if(idstr) {
        //    alert(idstr);
        //}
        if (window.XMLHttpRequest) {
            // AJAX mit IE7+, Chrome, Firefox, Safari, Opera
            var xmlhttp = new XMLHttpRequest();
        }
        xmlhttp.onreadystatechange = function() {
            // check if server returned the data:
            if (xmlhttp.readyState===4 && xmlhttp.status===200) {
                // search for id and replace with residuals text:
                document.getElementById("residuals").innerHTML = xmlhttp.responseText;
            }
        };
        // Make a POST request to the server
        xmlhttp.open("POST", "strflog.cgi", true);
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.send("id="+idstr);
    });

});

</script>



</body>
</html>
